The user lookup functionality for this lab is powered by a MongoDB NoSQL database. It is vulnerable to NoSQL injection.[](https://twitter.com/share?url=https%3A%2F%2Fportswigger.net%2Fweb-security%2Fnosql-injection%2Flab-nosql-injection-extract-data)

To solve the lab, extract the password for the `administrator` user, then log in to their account.

You can log in to your own account using the following credentials: `wiener:peter`.  
<br/>1\. Notice the request is vulnerable to javascript injection, we inject the payload `'+'`and URL encode it  
![b8cd72f30281db804259f773da1cc4b0.png](../_resources/b8cd72f30281db804259f773da1cc4b0-1.png)  
<br/>2\. We inject a true payload to see how it responds  
<br/>![3fcb14dc2e245307e70a9db861941959.png](../_resources/3fcb14dc2e245307e70a9db861941959-1.png)  
<br/>and with the same payload we can retreive administrators' information  
<br/>![4f0cf08c643a716b3ab21210c951f8ba.png](../_resources/4f0cf08c643a716b3ab21210c951f8ba-1.png)  
<br/>3\. Get password  
<br/>3.1 Password length  
<br/>With the payload`' && this.password.length < 30 || 'a'=='b`we can get the password length  
We sent it to intruder and get create an attack that will change the number from 0 to 30  
![8dd12c90f02b1ebeb9f6448c51e223a7.png](../_resources/8dd12c90f02b1ebeb9f6448c51e223a7-1.png)  
<br/>Notice that when the payload hits from number 1-8 the request could not find the user, meaning the passwords' length is 8 characters  
<br/>![189b157fb1ebfc34ea40a0bd59a36b24.png](../_resources/189b157fb1ebfc34ea40a0bd59a36b24-1.png)  
<br/>From numbers 9-30 the response contains the password information  
![ab6e73042b9add30c25e2c54f6bdf50c.png](../_resources/ab6e73042b9add30c25e2c54f6bdf50c-1.png)  
<br/><br/>3.2 Get the password content

We are going to create an intruder attack with a new payload: `' && this.password[ยง0ยง]=='ยงaยง`with this we are going to create a cluster bomb attack, being the first payload numbers from 0-7 because the password has 8 characters and the second payload characters from a-z.  
<br/>With this we are going to create all possible combinations of both payloads and get the password.  
<br/>![efe71ca47da6a15445ef96ab9afaaa60.png](../_resources/efe71ca47da6a15445ef96ab9afaaa60-1.png)  
<br/>If the response returns the account information it means payloads were valid and with that we get the password  
<br/>![75c90572179885a291e72ceb122d42ee.png](../_resources/75c90572179885a291e72ceb122d42ee-1.png)  
<br/>